---
layout: post
title: Lab 2!
subtitle: Query World Bank API
cover-img: /assets/img/path.jpg
thumbnail-img: /assets/img/thumb.png
share-img: /assets/img/path.jpg
tags: [books, test]
author: Ruby Wildman
---


# Lab 2: Part 1
## What extra query parameters did you use to query the World Bank API?

The extra query parameters I used to query the World Bank API, apart from the standard code for the indicators I chose, were the country’s ISO3 code and the range of years from which to collect data. This allowed me to search for a specific country’s statistics for that indicator for a range of years that I could choose. 
~~~
country_iso3: specifies the 3-letter ISO code for the country (ex:  'AFG' for Afghanistan)
indicator: represents the indicator code for the data you're interested in (e.g., 'SP.DYN.LE00.IN' for life expectancy)
date: specifies the range of years for which data is requested (from start_year to end_year).
format=json: specifies that the response should be in JSON format (allows the data to be read)
~~~
I implemented these query parameters in my url so it looked like this:
~~~
url = f"https://api.worldbank.org/v2/country/{country_iso3}/indicator/{indicator}?date={start_year}:{end_year}&format=json"
~~~

## What is the default number of results do you get per page?

 The World Bank API usually returns a default of 50 results per each page when querying data. However, in my case, this code doesn't handle pagination, so I would only recieve the first 50 results per query if there were more than 50 data points for a certain indicator. 

## How do you get more results? Can you write code to guarantee that you get full coverage for the results?

If I wanted to get more than 50 results I would need to implement pagination by making more requests to the World Bank API. Because this API allows pagination, I could pass a page parameter in the query to retrieve the next set of results. To do this I implemented this into my world_data function which determines how many results there are and whether there needs to be an extra page or not. The code looks like this:

~~~ 
def world_data(indicator, country_iso3, start_year, end_year):
    page = 1  # Start with the first page
    all_data = []
    
    while True:
        url = f"https://api.worldbank.org/v2/country/{country_iso3}/indicator/{indicator}?date={start_year}:{end_year}&page={page}&format=json"
        response = requests.get(url)
        
        if response.status_code == 200:
            data = response.json()
            if len(data) > 1:  #check to see if the data is valid
                all_data.extend(data[1])  #add the results from page to the full data list
                
                # checks to see if the results are less than 50, if it is then code ends, if not then you add another page
                if len(data[1]) < 50:
                    break
                page += 1  # Otherwise, go to the next page
            else:
                break
        else:
            print(f"Failed to fetch data for {indicator} for {country_iso3}")
            break
    
    return all_data
~~~

## 2. What indicators from the world bank did you choose to look at besides population, life expectancy, and GDP per capita? Why?

In addition to population, life expectancy, and GDP per capita, I chose 5 other indicators related to education: Government Expenditure on Education (% of GDP), Pupil-Teacher Ratio in Primary Education, Literacy Rate (15-24 yrs), Primary School Enrollment, and Primary School Completion Rate. I chose these indicators because they provide a more comprehensive view of a country’s development, particularly in terms of education and government investment, which are crucial for long-term socio-economic growth.

## 3. Did you filter any countries out? How, and why?

I didn't filter any countries out, instead, I filtered them in. My code filters countries based on their ISO3 code and searches for these country codes in the list "country_codes." If you wanted to search for another country or one specific country, you can add the country's iso3 code to the list. In my list, I selected the following countries:

~~~

#country ISO3 codes
country_codes = ['AFG', 'USA', 'DZA', 'NER', 'SSD', 'CHN', 'DEU', 'CAN']  
# USA, Afghanistan, Algeria, Niger, South Sudan, China, Germany, Canada (in order)
~~~

I specifically chose these countries because they're a mix of developed and developing countries, are in different places around the world, and have different levels of economic development and educational systems (the main reason I chose these countries explicitly)

## 4. Did you filter any years out? How, and why?

Similar to the previous question, the years weren't filtered out, but rather filtered in. I controlled a specific range of years to collect data from (start_year, end_year):

~~~
#year range for data collection
start_year = 1995
end_year = 2023
~~~

This means that data from 1995 to 2023 was requested in the API for each indicator. I did this because I wanted to focus on a specific time period to align with significant global events(specifically the COVID era and years leading up to it)

## 5. Did you find any interesting correlations betwen indicators? What were they? Did they have low p-values? 

Haven't queried Ms. Feng's API yet